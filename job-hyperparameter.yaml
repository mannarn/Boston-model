apiVersion: batch/v1
kind: Job
metadata:
  name: trial-{{N_ESTIMATORS}}-{{MAX_DEPTH}}-{{LEARNING_RATE}}-{{SUBSAMPLE}}
  labels:
    app: xgb-hyperparameter-tuning
    trial: "true"
spec:
  template:
    metadata:
      labels:
        app: trial
        n_estimators: "{{N_ESTIMATORS}}"
        max_depth: "{{MAX_DEPTH}}"
        learning_rate: "{{LEARNING_RATE}}"
        subsample: "{{SUBSAMPLE}}"
    spec:
      containers:
      - name: xgb-trainer
        image: hp-xgboost
        imagePullPolicy: Never
        args:
        - "--n_estimators={{N_ESTIMATORS}}"
        - "--max_depth={{MAX_DEPTH}}"
        - "--learning_rate={{LEARNING_RATE_RAW}}"  # Use raw value for the model
        - "--subsample={{SUBSAMPLE_RAW}}"          # Use raw value for the model
        volumeMounts:
        - name: data-volume
          mountPath: /data
      restartPolicy: Never
      volumes:
      - name: data-volume
        hostPath:
          path: /data
          type: DirectoryOrCreate